<!doctype html>
<html ng-app="fatCatsFeeding">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>FatCats - Feline Feeding Monitor</title>

  <!-- SCROLLS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
  <style>
      html                    { overflow-y:scroll; }
      body                    { padding-top:50px; }
      #feeding-list           { margin-bottom:30px; }
      #quantity-input { width: 90px; }
  </style>

  <!-- SPELLS -->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script> <!-- load jquery -->
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.9/angular.min.js"></script><!-- load angular -->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.4.4/underscore-min.js"></script>
  <script src="js/core.js"></script>
</head>
<body ng-controller="Controller">
    <div class="container">
      <div class="jumbotron text-center">
        <h1>Last fed <span class="label label-info"><my-elapsed></my-elapsed></span></h1>
        <h3>Feeding Counter <span class="label label-info">{{ feedings.length }}</span></h3>
      </div>
      <!-- Undo Alert -->
      <div class="alert alert-danger" role="alert" ng-show="showUndo">
        <div class="row">
          <div class="col-sm-8">
            <strong>{{ feedDate | date : "MMMM d, y '@' HH:mm 'CDT('Z')'" : 'CDT' }} Feeding record has been removed!</strong>
          </div>
          <div class="col-sm-4">
            <button class="btn btn-link pull-right" ng-click="undoRemove()">Click to undo</button>
          </div>
        </div>
      </div>
      <!-- Table Control Start -->
      <div class="row">
          <div class="col-xs-6">
            <h4 class="pull-left">Feeding Times <br/><small>Last {{quantity}}</h4>
          </div>
          <div class="col-xs-6">
            <div class="form-group form-inline pull-right">
              <button class="btn btn-default" ng-click="quantity = 5">5</button>
              <button class="btn btn-default"  ng-click="quantity = 10">10</button>
              <button class="btn btn-default"  ng-click="quantity = 20">20</button>
              <input type="number" ng-model="quantity" class="form-control" id="quantity-input" placeholder="5">
            </div>
          </div>
      </div>
      <!-- table start -->
      <div id="feeding-list" class="row">
        <div class="col-sm-12">
          <table class="table table-striped table-bordered">
            <tr>
              <th>Date Time</th>
              <th>Food Type</th>
              <th>Amount Fed</th>
            </tr>
            <tr ng-repeat="feeding in feedings | limitTo:quantity">
              <td>
                {{ feeding.datetime | date : "MMMM d, y '@' HH:mm 'CDT('Z')'" : 'CDT'}}
              </td>
              <td>
                <select
                  ng-init="feedFood = feeding.food"
                  ng-model="feedFood"
                  ng-options="catfood._id as catfood.brand+' '+catfood.name for catfood in catfoods"
                  ng-change="update(feeding._id, feedFood, feeding.amount)">
                </select>
              </td>
              <td ng-repeat="catfood in catfoods | filter: {'_id':feedFood} : true">
                <select
                  ng-init="feedAmount = feeding.amount"
                  ng-model="feedAmount"
                  ng-options="amount.id as amount.id for amount in amounts"
                  ng-change="update(feeding._id, feedFood, feedAmount)">
                </select>
                {{ catfood.measurement }}
              </td>
              <td>
                <button class="btn btn-danger" ng-click="removeFeeding(feeding._id, feeding.datetime)">X</button>
              </td>
            </tr>
          </table>
        </div>
      </div>
    </div>
</body>
